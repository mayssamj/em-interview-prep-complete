"use strict";(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},7219:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>R,requestAsyncStorage:()=>w,routeModule:()=>x,serverHooks:()=>U,staticGenerationAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{POST:()=>f,dynamic:()=>h});var n=t(9303),a=t(8716),i=t(670),o=t(7070),u=t(2023),d=t.n(u),p=t(1482),l=t.n(p),m=t(9487),c=t(4673);let h="force-dynamic",g=process.env.JWT_SECRET||"your-secret-key";async function f(e){try{let{username:r,password:t}=await e.json();if(!r||!t)return o.NextResponse.json({error:"Username and password are required"},{status:400});if(t.length<6)return o.NextResponse.json({error:"Password must be at least 6 characters long"},{status:400});if(await m._.users.findUnique({where:{username:r}}))return o.NextResponse.json({error:"Username already exists"},{status:409});let s=await d().hash(t,12),n=await m._.users.create({data:{id:(0,c.Z)(),username:r,password_hash:s,created_at:new Date,updated_at:new Date}}),a=l().sign({userId:n.id,username:n.username,isAdmin:n.is_admin},g,{expiresIn:"24h"}),i=o.NextResponse.json({message:"Registration successful",user:{id:n.id,username:n.username,isAdmin:n.is_admin}});return i.cookies.set("token",a,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:86400}),i}catch(e){return console.error("Registration error:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let x=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/home/ubuntu/em-interview-prep/app/api/auth/register/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:w,staticGenerationAsyncStorage:y,serverHooks:U}=x,v="/api/auth/register/route";function R(){return(0,i.patchFetch)({serverHooks:U,staticGenerationAsyncStorage:y})}},9487:(e,r,t)=>{t.d(r,{_:()=>n});var s=t(3524);let n=globalThis.prisma??new s.PrismaClient},4673:(e,r,t)=>{t.d(r,{Z:()=>u});var s=t(4770);let n={randomUUID:s.randomUUID},a=new Uint8Array(256),i=a.length,o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));let u=function(e,r,t){if(n.randomUUID&&!r&&!e)return n.randomUUID();let u=(e=e||{}).random??e.rng?.()??(i>a.length-16&&((0,s.randomFillSync)(a),i=0),a.slice(i,i+=16));if(u.length<16)throw Error("Random bytes length must be >= 16");if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,r){if((t=t||0)<0||t+16>r.length)throw RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let e=0;e<16;++e)r[t+e]=u[e];return r}return function(e,r=0){return(o[e[r+0]]+o[e[r+1]]+o[e[r+2]]+o[e[r+3]]+"-"+o[e[r+4]]+o[e[r+5]]+"-"+o[e[r+6]]+o[e[r+7]]+"-"+o[e[r+8]]+o[e[r+9]]+"-"+o[e[r+10]]+o[e[r+11]]+o[e[r+12]]+o[e[r+13]]+o[e[r+14]]+o[e[r+15]]).toLowerCase()}(u)}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,2023,1482],()=>t(7219));module.exports=s})();